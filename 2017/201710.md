# Difficulties & Bug

### 一、ios上audio无法自动播放
>暂时没有解决方法，只能通过监听点击事件播放

### 二、h5页面唤起app，若没有app则跳转下载页面
>ios

```bash
window.location.href = link;
setTimeout(function(){
  //跳转两次可以使ios默认弹框消失
  window.location.href = downloadUrl;
  window.location.href = downloadUrl;
},2000);
```
>安卓：由于安卓是多任务，应用会进入后台，所以若使用ios的方法，则既会跳转app，也会跳转下载页面。

>原理：设置一个运行间隔20ms，总计运行100次的定时器，如果页面一直处于前台，则100次跑完，总耗时与 100x20=2000ms不会有太大差异，但页面在后台运行时，此时间会明显超过2000ms。可以利用这一点来实现是否成功打开APP检测及回调。

```bash
window.location.href = link;
var _clickTime = +(new Date());
function check(elsTime) {
    if ( elsTime > 3000 || document.hidden || document.webkitHidden) {
    } else {
        window.location.href = downloadUrl;
    }
}
//启动间隔20ms运行的定时器，并检测累计消耗时间是否超过3000ms，超过则结束
var _count = 0, intHandle;
intHandle = setInterval(function(){
    _count++;
    var elsTime = +(new Date()) - _clickTime;
    if (_count>=100 || elsTime > 3000 ) {
        clearInterval(intHandle);
        check(elsTime);
    }
}, 20);
```

# knowledge
### 一、单行文本溢出显示省略号

``` bash
.ellipsis{
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
```

### 二、多行文本溢出显示省略号
>WebKit浏览器或移动端的页面

``` bash
.ellipsis{
  overflow : hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
```
